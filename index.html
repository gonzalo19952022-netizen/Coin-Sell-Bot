<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Niva Farmer Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --blue: #007bff; --green: #28a745; --red: #dc3545; }
        body { font-family: sans-serif; background-color: #f0f2f5; margin: 0; padding: 15px; }
        .screen { display: none; }
        .active-screen { display: block; }
        .profile-card { background: white; padding: 15px; border-radius: 15px; display: flex; align-items: center; margin-bottom: 15px; }
        .profile-card img { width: 50px; height: 50px; border-radius: 50%; margin-right: 15px; border: 2px solid var(--blue); }
        .btn-join { background: var(--green); color: white; text-align: center; padding: 12px; border-radius: 10px; text-decoration: none; display: block; margin-bottom: 20px; font-weight: bold; }
        .coin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .coin-box { background: white; padding: 10px; border-radius: 10px; position: relative; border: 1px solid #ddd; }
        .status { position: absolute; top: 5px; right: 5px; font-size: 10px; padding: 2px 5px; border-radius: 4px; }
        .active { background: #e8f5e9; color: green; }
        .stop { background: #ffebee; color: red; }
        .btn-blue { background: var(--blue); color: white; width: 100%; padding: 15px; border: none; border-radius: 10px; font-weight: bold; margin-top: 20px; }
        input, select { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
    </style>
</head>
<body>

    <div id="homeScreen" class="screen active-screen">
        <div class="profile-card">
            <img id="userImg" src="https://via.placeholder.com/50">
            <div><b id="userName">User</b><br><small id="userId">ID: 0000</small></div>
        </div>
        <a href="https://t.me/yourchannel" class="btn-join">Join Official Channel</a>
        <h3>Live Market Rate</h3>
        <div class="coin-grid">
            <div class="coin-box">NIVA<br><b>5.7৳</b><span class="status active">Active</span></div>
            <div class="coin-box">TOP<br><b>6.15৳</b><span class="status stop">Stop</span></div>
            <div class="coin-box">NS<br><b>13৳</b><span class="status active">Active</span></div>
            <div class="coin-box">FIRA<br><b>1৳</b><span class="status stop">Stop</span></div>
        </div>
        <button class="btn-blue" onclick="showScreen('sellScreen')">SELL COIN NOW</button>
        <button class="btn-blue" style="background:#e91e63" onclick="showScreen('withdrawScreen')">WITHDRAW</button>
    </div>

    <div id="sellScreen" class="screen">
        <h3>Sell Coins</h3>
        <label>Select Coin</label>
        <select id="coinType">
            <option value="5.7">NIVA COIN</option>
            <option value="13">NS COIN</option>
        </select>
        <input type="number" id="amount" placeholder="Amount (Min 10,000)">
        <input type="text" id="insta" placeholder="Your Instagram Username">
        <button class="btn-blue" onclick="showScreen('homeScreen')">Back</button>
        <button class="btn-blue" onclick="alert('ভেরিফিকেশন সম্পন্ন!')">NEXT STEP</button>
    </div>

    <div id="withdrawScreen" class="screen">
        <h3>Withdraw (Bkash/Rocket)</h3>
        <select id="wMethod" onchange="calcW()">
            <option value="BKASH">Bkash (Min 50৳)</option>
            <option value="ROCKET">Rocket (Min 100৳)</option>
        </select>
        <input type="number" id="wAmount" placeholder="Amount" oninput="calcW()">
        <div id="wMsg" style="margin-top:10px; color:green; font-weight:bold;"></div>
        <button class="btn-blue" onclick="showScreen('homeScreen')">Back</button>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        document.getElementById('userName').innerText = tg.initDataUnsafe.user?.first_name || "Guest";
        document.getElementById('userId').innerText = "ID: " + (tg.initDataUnsafe.user?.id || "0000");

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
            document.getElementById(id).classList.add('active-screen');
        }

        function calcW() {
            let m = document.getElementById('wMethod').value;
            let a = document.getElementById('wAmount').value;
            let c = 0;
            if(m === "BKASH" && a >= 50) c = Math.floor(a/50)*1;
            if(m === "ROCKET" && a >= 100) c = Math.floor(a/100)*1;
            document.getElementById('wMsg').innerText = a > 0 ? "চার্জ: " + c + "৳, পাবেন: " + (a-c) + "৳" : "";
        }
    </script>
</body>
</html>
